parameter bytes;
storage (pair (map address mutez) (map address timestamp));
code { DUP ;
       DIP { CDR @storage_slash_1 } ;
       CAR @parameter_slash_2 ;
       DUP @parameter ;
       PUSH nat 4 ;
       PUSH nat 0 ;
       SLICE ;
       IF_NONE { PUSH nat 100 ; FAILWITH } {} ;
       RENAME @res10 ;
       DUP @res10 ;
       PUSH bytes 0xdde2916a ;
       COMPARE @_ ;
       DUUP @res10 ;
       PUSH bytes 0xdde2916a ;
       COMPARE ;
       EQ ;
       IF { PUSH int 10 ;
            PUSH mutez 1 ;
            AMOUNT ;
            EDIV ;
            IF_NONE { PUSH string "Error with casting" ; FAILWITH } {} ;
            CAR ;
            PUSH int 1 ;
            MUL ;
            EDIV ;
            IF_NONE { PUSH string "Divisible by 0" ; FAILWITH } {} ;
            CAR @var58_fst59 ;
            PUSH @pair27 (pair (option int) (option mutez)) (Pair None None) ;
            NONE int ;
            PAIR ;
            DUUP @var58_fst59 ;
            PAIR @pair60 ;
            DUUUUUUP @storage ;
            NIL operation ;
            PAIR ;
            DUUP @pair60 ;
            PAIR @_ ;
            PUSH int 0 ;
            DUUUUP @var58_fst59 ;
            COMPARE ;
            GT ;
            IF { UNIT } { PUSH string "Mutez conversion not possible" ; FAILWITH } ;
            DROP ;
            SELF ;
            ADDRESS ;
            CONTRACT unit ;
            IF_NONE { PUSH string "Invalid contract" ; FAILWITH } {} ;
            PUSH mutez 1 ;
            DUUUUUP @var58_fst59 ;
            DUP ;
            ABS ;
            SWAP ;
            GE ;
            IF {} {} ;
            MUL ;
            UNIT ;
            TRANSFER_TOKENS @exp86 ;
            NIL operation ;
            DUUP @exp86 ;
            CONS @cons87 ;
            DUUUUUUUUUP @storage ;
            DUUP @cons87 ;
            PAIR @pair88 ;
            DUP @pair88 ;
            DUUUUUUP @pair60 ;
            PAIR @_ ;
            PUSH bool True ;
            DUUUUUUUUUUUUP @storage ;
            CDR ;
            SENDER ;
            MEM ;
            COMPARE ;
            NEQ ;
            IF { DUUUUUUUUUUUP @storage ;
                 CDR ;
                 NOW ;
                 SENDER ;
                 DIP { SOME } ;
                 UPDATE @update103 ;
                 DUUUUUUUUUUUUP @storage ;
                 CAR @storage_fst104 ;
                 DUUP @update103 ;
                 DUUP @storage_fst104 ;
                 PAIR ;
                 DUUUUUUP @cons87 ;
                 PAIR ;
                 DUUUUUUUUUP @pair60 ;
                 PAIR @_ ;
                 DUUUP @update103 ;
                 DUUUP @storage_fst104 ;
                 AMOUNT ;
                 SENDER ;
                 DIP { SOME } ;
                 UPDATE ;
                 PAIR ;
                 DUUUUUUUP @cons87 ;
                 PAIR ;
                 DUUUUUUUUUUP @pair60 ;
                 PAIR @_ ;
                 PUSH string "Successfully registered" ;
                 FAILWITH }
               { UNIT } ;
            DROP ;
            PUSH int 3600 ;
            DUUUUUUUUUUUUP @storage ;
            CDR ;
            SENDER ;
            GET ;
            IF_NONE { PUSH string "Key not found in map" ; FAILWITH } {} ;
            NOW ;
            SUB ;
            EDIV ;
            IF_NONE { PUSH string "Divisible by 0" ; FAILWITH } {} ;
            CAR @var143_fst144 ;
            DUUUP @pair88 ;
            PUSH @pair27 (pair (option int) (option mutez)) (Pair None None) ;
            DUUUP @var143_fst144 ;
            PAIR ;
            DUUUUUUUUUUP @var58_fst59 ;
            PAIR ;
            PAIR @_ ;
            PUSH int 3600 ;
            DUUUP @var143_fst144 ;
            COMPARE @_ ;
            PUSH int 3600 ;
            DUUUUP @var143_fst144 ;
            COMPARE ;
            LT ;
            IF { PUSH string "Spent time is less than 1 hour" ; FAILWITH } { UNIT } ;
            DROP ;
            PUSH int 3600 ;
            DUUUUP @var143_fst144 ;
            EDIV ;
            IF_NONE { PUSH string "Divisible by 0" ; FAILWITH } {} ;
            CAR @var168_fst169 ;
            DUUUUUUP @pair88 ;
            NONE mutez ;
            DUUUP @var168_fst169 ;
            PAIR ;
            DUUUUUUP @var143_fst144 ;
            PAIR ;
            DUUUUUUUUUUUUUP @var58_fst59 ;
            PAIR ;
            PAIR @_ ;
            DUUP @var168_fst169 ;
            PUSH int 0 ;
            EDIV ;
            IF_NONE { PUSH string "Divisible by 0" ; FAILWITH } {} ;
            CDR ;
            DUUUUUUUUUUUUUUUUUP @storage ;
            CAR ;
            SENDER ;
            GET ;
            IF_NONE { PUSH string "Key not found in map" ; FAILWITH } {} ;
            EDIV ;
            IF_NONE { PUSH string "Divisible by 0" ; FAILWITH } {} ;
            CDR @var207_snd208 ;
            DUP @var207_snd208 ;
            DUUUUP @var168_fst169 ;
            PAIR ;
            DUUUUUUUP @var143_fst144 ;
            PAIR ;
            DUUUUUUUUUUUUUUP @var58_fst59 ;
            PAIR @pair211 ;
            DUUUUUUUUUP @pair88 ;
            DUUP @pair211 ;
            PAIR @_ ;
            BALANCE @balance213 ;
            DUUUUP @var207_snd208 ;
            DUUP @balance213 ;
            COMPARE @_ ;
            DUUUUUP @var207_snd208 ;
            DUUUP @balance213 ;
            COMPARE ;
            LT ;
            IF { PUSH string "Not enough money" ; FAILWITH } { UNIT } ;
            DROP ;
            SENDER ;
            CONTRACT unit ;
            IF_NONE { PUSH string "Invalid contract" ; FAILWITH } {} ;
            DUUUUUUP @var207_snd208 ;
            UNIT ;
            TRANSFER_TOKENS @exp235 ;
            DUUUUUUUUUUUUUUP @cons87 ;
            DUUP @exp235 ;
            CONS @cons236 ;
            DUUUUUUUUUUUUUUUUUUUUUUUP @storage ;
            DUUP @cons236 ;
            PAIR ;
            DUUUUUUUP @pair211 ;
            PAIR @_ ;
            DUUUUUUUUUUUUUUUUUUUUUUUUP @storage ;
            CDR ;
            NOW ;
            SENDER ;
            DIP { SOME } ;
            UPDATE @update243 ;
            DUUUUUUUUUUUUUUUUUUUUUUUUUP @storage ;
            CAR @storage_fst244 ;
            DUUP @update243 ;
            DUUP @storage_fst244 ;
            PAIR ;
            DUUUUUP @cons236 ;
            PAIR ;
            DUUUUUUUUUUP @pair211 ;
            PAIR @_ ;
            AMOUNT ;
            DUUUP @storage_fst244 ;
            SENDER ;
            GET ;
            IF_NONE { PUSH string "Key not found in map" ; FAILWITH } {} ;
            ADD @add261 ;
            DUP @add261 ;
            SOME @_ ;
            DUUUUUP @update243 ;
            DUUUUUP @storage_fst244 ;
            DUUUUP @add261 ;
            SENDER ;
            DIP { SOME } ;
            UPDATE ;
            PAIR ;
            DUUUUUUUUP @cons236 ;
            PAIR @pair265 ;
            DUP @pair265 ;
            DUUUUUUUUUUUUUUP @pair211 ;
            PAIR @_ ;
            DROP ;
            DIP { DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP ;
                  DROP } }
          { PUSH nat 400 ; FAILWITH } ;
       DIP { DROP ; DROP ; DROP ; DROP } };
